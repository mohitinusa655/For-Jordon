<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>For You ‚ù§Ô∏è</title>
<style>
  body {
    margin: 0;
    height: 100vh;
    background: radial-gradient(circle, #ffd1dc, #ff9a9e);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    font-family: "Segoe Script", cursive;
    overflow: hidden;
    text-align: center;
    padding: 20px;
  }

  /* --- Button Styling --- */
  .btn-container { position: relative; z-index: 10; }
  button {
    font-size: 22px;
    padding: 14px 34px;
    border-radius: 18px;
    border: none;
    cursor: pointer;
    margin: 10px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    transition: transform 0.2s;
  }
  button:active { transform: scale(0.95); }
  #yes { background: #ff2f6d; color: white; }
  #no { background: #999; color: white; position: absolute; }
  h1 { color: #b8003c; margin-bottom: 20px; }

  /* --- Lyrics Styling --- */
  #lyrics {
    position: absolute;
    top: 40%;
    width: 90%;
    font-size: 28px;
    color: #b8003c;
    text-shadow: 0 0 10px rgba(255, 255, 255, 0.8);
    pointer-events: none;
    min-height: 100px;
  }
  
  .word {
    opacity: 0.2; /* Dim by default */
    transition: opacity 0.3s, color 0.3s;
    margin: 0 3px;
    display: inline-block;
  }
  
  .word.highlight {
    opacity: 1;
    color: #6a0020;
    transform: scale(1.1);
    text-shadow: 0 0 15px #ff2f6d;
  }

  /* --- Proposal Screen --- */
  #proposal { display: none; z-index: 20; animation: fadeIn 2s ease; }
  #name {
    font-size: 42px;
    color: #ff2f6d;
    text-shadow: 0 0 15px #ff7aa2;
    animation: glow 2s infinite alternate;
  }
  #ring {
    font-size: 90px;
    cursor: pointer;
    margin: 20px 0;
    animation: sparkle 1.5s infinite alternate;
  }
  #finalMsg { font-size: 22px; color: #7a0026; margin-top: 15px; }

  /* --- Animations --- */
  .float { position: fixed; font-size: 28px; animation: rise 6s linear forwards; pointer-events: none; z-index: 1; }
  .firework { position: fixed; font-size: 40px; animation: explode 1.5s ease-out forwards; pointer-events: none; z-index: 30; }

  @keyframes rise { from { transform: translateY(110vh); opacity: 1; } to { transform: translateY(-10vh); opacity: 0; } }
  @keyframes sparkle { from { transform: scale(1); } to { transform: scale(1.2); } }
  @keyframes explode { from { transform: scale(0); opacity: 1; } to { transform: scale(4); opacity: 0; } }
  @keyframes glow { from { text-shadow: 0 0 10px #ff7aa2; } to { text-shadow: 0 0 25px #ff2f6d; } }
  @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
</style>
</head>
<body>

<div id="initial-screen">
  <h1 id="question">Will you be my Valentine? ‚ù§Ô∏è</h1>
  <div class="btn-container">
    <button id="yes">Yes üíñ</button>
    <button id="no">No üò¢</button>
  </div>
</div>

<div id="lyrics"></div>

<div id="proposal">
  <div id="name"></div>
  <div id="ring">üíç</div>
  <h1>Will you be mine forever? ‚ù§Ô∏è</h1>
  <div id="finalMsg">Tap the ring üíç</div>
</div>

<audio id="song" src="perfect.mp3" preload="auto"></audio>

<script>
// ==========================================
// ‚öôÔ∏è SETTINGS
// ==========================================
const herName = "Jordon"; 

// ‚è±Ô∏è START TIME: When does he start singing "I found a love"?
// If lyrics are EARLY: Increase this (e.g., 19.0)
// If lyrics are LATE: Decrease this (e.g., 18.0)
const startTime = 18.5; 

// üéµ LYRICS DATA (Synced to standard recording)
const lyricsData = [
  { text: "I found a love for me", time: 0, duration: 8 },
  { text: "Darling, just dive right in and follow my lead", time: 8.5, duration: 8 },
  { text: "Well, I found a girl, beautiful and sweet", time: 17, duration: 8 },
  { text: "Oh, I never knew you were the someone waitin' for me", time: 25.5, duration: 8 },
  { text: "'Cause we were just kids when we fell in love", time: 34, duration: 6 }
];
// ==========================================

const song = document.getElementById("song");
const yesBtn = document.getElementById("yes");
const noBtn = document.getElementById("no");
const lyricsDiv = document.getElementById("lyrics");
const proposal = document.getElementById("proposal");
const nameDiv = document.getElementById("name");

nameDiv.textContent = herName;

let currentLineIndex = -1;
let wordInterval;

noBtn.addEventListener("mouseover", () => {
  const x = Math.random() * (window.innerWidth - 100);
  const y = Math.random() * (window.innerHeight - 50);
  noBtn.style.position = "fixed";
  noBtn.style.left = x + "px";
  noBtn.style.top = y + "px";
});

yesBtn.onclick = () => {
  document.getElementById("initial-screen").style.display = "none";
  song.currentTime = startTime;
  song.volume = 1;
  song.play().catch(e => alert("Please interact with the document first or check mp3 file."));
  startHearts();
  
  // End sequence timer (based on total lyrics duration)
  setTimeout(() => {
    fadeOutSong();
    showProposal();
  }, 42000); // 42 seconds after click
};

song.addEventListener("timeupdate", () => {
  const currentTime = song.currentTime - startTime;
  
  // Find the active line
  lyricsData.forEach((line, index) => {
    if (currentTime >= line.time && currentTime < (line.time + line.duration)) {
      if (currentLineIndex !== index) {
        currentLineIndex = index;
        showLine(line.text, line.duration);
      }
    }
  });
});

function showLine(text, duration) {
  // Clear previous
  clearInterval(wordInterval);
  lyricsDiv.innerHTML = "";
  lyricsDiv.style.opacity = 1;

  const words = text.split(" ");
  
  // Create spans
  words.forEach(word => {
    const span = document.createElement("span");
    span.textContent = word;
    span.className = "word";
    lyricsDiv.appendChild(span);
  });

  // Animate words one by one
  let wordIndex = 0;
  const wordSpans = document.querySelectorAll(".word");
  const timePerWord = (duration * 1000) / words.length;

  wordInterval = setInterval(() => {
    if (wordIndex < wordSpans.length) {
      wordSpans[wordIndex].classList.add("highlight");
      wordIndex++;
    } else {
      clearInterval(wordInterval);
    }
  }, timePerWord);
}

function fadeOutSong() {
  const fade = setInterval(() => {
    if (song.volume > 0.05) song.volume -= 0.05;
    else { song.pause(); clearInterval(fade); }
  }, 200);
}

function showProposal() {
  lyricsDiv.style.display = "none";
  proposal.style.display = "block";
}

const ring = document.getElementById("ring");
ring.onclick = () => {
  startFireworks();
  document.getElementById("finalMsg").textContent = "You are my today, my tomorrow, my forever ‚ù§Ô∏è";
};

function startHearts() {
  setInterval(() => {
    const el = document.createElement("div");
    el.className = "float";
    el.textContent = Math.random() > 0.5 ? "‚ù§Ô∏è" : "üåπ";
    el.style.left = Math.random() * 100 + "vw";
    document.body.appendChild(el);
    setTimeout(() => el.remove(), 6000);
  }, 300);
}

function startFireworks() {
  setInterval(() => {
    const fw = document.createElement("div");
    fw.className = "firework";
    fw.textContent = "üéÜ";
    fw.style.left = Math.random() * 100 + "vw";
    fw.style.top = Math.random() * 60 + "vh";
    document.body.appendChild(fw);
    setTimeout(() => fw.remove(), 2500);
  }, 400);
}
</script>
</body>
</html>
